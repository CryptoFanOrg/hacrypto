<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>OpenSSL Software Foundation, Inc.</title>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <meta name="resource-type" content="document">
  <meta name="description" content="OpenSSL Software Foundation home page">
  <meta name="keywords" content="OSF">
  <meta name="distribution" content="global">
  <meta name="copyright" content="Copyright 2009-2014 by OSF">
</head>
<body topmargin="0" leftmargin="0" marginheight="0" marginwidth="0" text="#000000" bgcolor="#ffffff">
<table height="100%" width="100%" border="0" cellpadding="1" cellspacing="0" summary="">
<tbody>
  <tr>
    <td rowspan="2" valign="top" bgcolor="#b0b0b0">
      <br>
      <table cellspacing="0" cellpadding="0" border="0" summary="">
<a href="../index.html" onmouseover="self.status = '../'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../'; return true" onblur="self.status = ''; return true"><b><big>Home</big></b><br></a>
  </table>
      <p><hr></p>
      <b><big>About OSF</big></b><br>
      <table cellspacing="0" cellpadding="0" border="0" summary="">
&nbsp;<a href="../what.html" onmouseover="self.status = '../what.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../what.html'; return true" onblur="self.status = ''; return true">What We Do<br></a>&nbsp;<a href="../who.html" onmouseover="self.status = '../who.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../who.html'; return true" onblur="self.status = ''; return true">Who We Are<br></a>&nbsp;<a href="../contact.html" onmouseover="self.status = '../contact.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../contact.html'; return true" onblur="self.status = ''; return true">Contact Info<br></a>
  </table>
      <p><hr></p>
      <b><big>Resources</big></b><br>
      <table cellspacing="0" cellpadding="0" border="0" summary="">
&nbsp;<a href="http://openssl.org" onmouseover="self.status = 'http://openssl.org'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = 'http://openssl.org'; return true" onblur="self.status = ''; return true">OpenSSL<br></a>&nbsp;<a href="../download.html" onmouseover="self.status = '../download.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../download.html'; return true" onblur="self.status = ''; return true">Download<br></a>&nbsp;<a href="index.html" onmouseover="self.status = '../fips/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../fips/'; return true" onblur="self.status = ''; return true">FIPS&nbsp;140-2<br></a>&nbsp;<a href="http://openssl.com/testing/" onmouseover="self.status = '../testing/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../testing/'; return true" onblur="self.status = ''; return true">Testing<br></a>&nbsp;<a href="../data/index.html" onmouseover="self.status = '../data/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../data/'; return true" onblur="self.status = ''; return true">Data&nbsp;Archives<br></a>&nbsp;<a href="../export/index.html" onmouseover="self.status = '../export/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../export/'; return true" onblur="self.status = ''; return true">Export<br></a>&nbsp;<a href="../mirrors.html" onmouseover="self.status = '../mirrors.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../mirrors.html'; return true" onblur="self.status = ''; return true">Mirrors<br></a>
  </table>
      <p><br></p>
    </td>
    <td rowspan="2" bgcolor="#7f7f7f"><font size="1">&nbsp;</font>
    </td>
    <td valign="top" bgcolor="#ffffff"><div align="center">
	
<title>OpenSSL Software Foundation, Inc.</title>
<h1>FAQ - The I.G. 9.5 Issue</h1>
Last <a href="ig95.html#updates">update</a> 2013-08-12
<p>
<div align="left">
<hr>
<font color="#cc3333">UPDATE 2013-08-12:&nbsp;</font>On 2013-07-25 the CMVP revised the
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/fips140-2/FIPS1402IG.pdf">Implementation Guidance</a>
(I.G.) document to effectively supersede the issues documented below with a new prescriptive requirement in section
9.10 (so the "I.G. 9.5 issue" is now the "I.G. 9.10 issue").
<p>
Satisfaction of this new requirement -- invocation of the POST operation from a constructor function -- appears
to be technically feasible for the OpenSSL FIPS Object Module, though we'll have to do an actual validation to
be sure.
<p>
The CMVP has also stated that the new I.G. 9.10 requirement does <em>not</em> apply to "change letter" updates
to the original OpenSSL FIPS Object Module 2.0 validation, <em>or</em> to "private label" validations derived from
it. This news comes as a tremendous relief to us after fearing for months that we would have to abandon our several
pending validations, or absorb huge costs in reworking the code and repeating the testing (our clients, unfortunately,
are still impacted by the schedule slippage).
<p>
So in principle private label validations are again possible, either using the original #1747 source code
baseline or with modifications to implement the constructor function POST. However, this and other recent incidents
have been a forceful reminder of the significant business risks in performing validations in an environment where
the requirements can change at any moment and retroactively impact efforts that may have been planned, contracted,
worked, and formally submitted months prior. We will consider again undertaking private validations for those clients
that request them, but we will be very reluctant to undertake them on a fixed price basis as has been our practice
in the past.
<hr>
<em>
<p>
Q1: What is the issue? Executive summary please.
<p>
</em>
<blockquote>
From time to time the strange little world of FIPS 140-2 validation testing manages to conjure thrills and
excitement from what is normally a very dull and boring topic.
The latest such surprise is a new interpretation<small><sup><a href="ig95.html#1">1</a></sup></small> of the "guidance" (mandatory requirement) in
section 9.5 of the
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/fips140-2/FIPS1402IG.pdf">Implementation Guidance</a>
(I.G.) document, a key canon of the FIPS 140-2 scripture. The bureaucracy responsible for such interpretations is
the <a href="http://csrc.nist.gov/groups/STM/cmvp/">CMVP</a>.
<p>
This new interpretation mandates some very disruptive changes to software libraries like the OpenSSL FIPS Object Module
("FIPS module")
and those derived from it (which is a large proportion of all validated software modules).
<p>
OSF will complete those <a href="http://www.openssl.org/docs/fips/fipsnotes.html#privatelabel">private label</a>
validations we are currently working on, as best we can, but we are no
longer accepting new private label validations for reasons that are discussed in more detail below.
We are not optimistic that any new FIPS module that satisfies this new requirement, or an accompanying "FIPS
capable" OpenSSL, will become available for the foreseeable future.
<p>
The existing OpenSSL FIPS Object Module 2.0 ("2.0 FIPS module"), validation certificate
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm#1747">#1747</a>,
is unaffected by this new requirement and will continue to be available as a validated cryptographic module.
We have already been contacted by several software vendors who had been planning on a private label
validation and are instead sponsoring additional platforms for the 2.0 FIPS module.
</blockquote>
<p>
<em>
<p>
Q2: We have a FIPS 140-2 validation currently in process. Are we affected?
<p>
</em>
<blockquote>
If your formal test report submission has already occurred (on or before December 27, 2012) then you're
in the clear. If not your validation is affected to an as yet unknown degree, and have presumably already been so informed by
your test lab.
<p>
<font color="#cc3333">UPDATE 2013-03-14:&nbsp;</font>Apparently there will be a transitional grace period of some
sort with a formal report submission deadline of November 15, 2013. It is not yet clear that the terms of this
transition are sufficient to allow completion of currently in-process validations without major recoding or retesting.
These transitional validations will carry a caveat to the effect of "This module has no assurance of integrity
in non-approved mode" that will have no practical impact on deployment or use of the module (the "assurance of
integrity" is only of interest in the context of FIPS 140-2 in approved mode).
<p>
For our current private label validation customers caught in this mess, OSF will if necessary hack a custom version
of the FIPS module to satisfy the new requirement, at our expense<small><sup><a href="ig95.html#2">2</a></sup></small>.
However, that will take additional time
(months perhaps) and will result in custom code that will no longer be compatible with official OpenSSL
releases. For that we sincerely apologize; we'll do what we can to get <em>something</em> validated but it
won't be the end result you were expecting and may not be usable for your original intended purposes. There
is a substantial element of risk to any FIPS 140-2 validation as this latest incident illustrates with a vengeance.
</blockquote>
<em>
<p>
Q3: Why is the new I.G. 9.5 requirement bad news?
<p>
</em>
<blockquote>
This new interpretation requires that none of the function calls in our
cryptographic library can return useful information until after the POST<small><sup><a href="ig95.html#3">3</a></sup></small>
is performed. It also requires that this restriction must be enforced in
the module, that is in the cryptographic library itself, and not merely stated as
a condition to be satisfied by the calling application.
<p>
Sounds trivial, right ... just set a flag or something? If
only that were so.
<p>
There are three inter-related issues that conspire to make this a nasty
problem: 1) hacking the module, 2) validating the module, and 3) hacking
the "FIPS capable" OpenSSL. All three are non-trivial undertakings that
collectively are very unlikely to be accomplished in less than about one to two
years, if ever.
</blockquote>
<em>
<p>
Q4: What hacks to the FIPS module will be required?
<p>
</em>
<blockquote>
First there is the problem that a library cannot choose which API
functions are called or when they are called; that is decided by the
calling applications. So, some mechanism must be used to disable all
function calls.
A simple global static variable won't work because the
POST itself calls many of the same API functions, and if those functions
are disabled the POST will see errors just as any external application
would. The POST can't just flip the global static variable without
introducing a race condition, as other threads could call those
functions while the POST was executing, which is a no-no not only from a
technical perspective (the code is no longer thread safe) but is also a
FIPS 140-2 scripture violation.
<p>
Note that by "all" functions we assume the functions intended to be part
of the external FIPS module interface, not all functions visible to the
linker at build time. Since the FIPS module is static object code ("monolithic
object module")<small><sup><a href="ig95.html#4">4</a></sup></small> it necessarily
contains global symbols that could in principle be referenced by
a calling application during the final link phase where the application
executable file is produced. Disabling the interface functions only is at
least theoretically possible; disabling <em>all</em> functions isn't possible
even in principle, in any sort of platform portable way<small><sup><a href="ig95.html#5">5</a></sup></small>
A mandate to disable <em>all</em> functions would effectively eliminate
the possibility of validating software for platforms that don't support
dynamic linking such as Apple iOS and many real-time operating systems.
<p>
For the POST to run while all functions are disabled we either need an
elaborate locking scheme or public/private wrappers for all the
necessary functions (many dozens to hundreds, see the FIPS module API
summary in the last 50 pages or so of the FIPS module
<a href="http://www.openssl.org/docs/fips/UserGuide-2.0.pdf">User Guide</a><small><sup><a href="ig95.html#6">6</a></sup></small>
to get a feel for what that would entail). The FIPS module already has a
horribly complicated scheme for avoiding symbol name conflicts; this
would pile on yet more complexity.
<p>
All in all a very non-trivial proposition, just to prevent
functions from working that are similar or identical to the uncontrolled
implementations residing in the regular OpenSSL library<small><sup><a href="ig95.html#7">7</a></sup></small>. A new
validation and new OpenSSL (see below) would also be needed.
</blockquote>
<em>
<p>
Q5: Will a new validation be required for the hacked FIPS module?
<p>
</em>
<blockquote>
Yes, and that's a problem ... a big one.
<p>
The OpenSSL FIPS Object Module validations are few and far between for a
reason: they are painful and expensive. All validations are expensive
and time-consuming, with the open source validations especially so<small><sup><a href="ig95.html#8">8</a></sup></small>.
Commercial vendors don't have a
significant incentive to pay for the open source based validations
(though we have had some notable minority
<a href="http://www.openssl.org/docs/fips/fipsvalidation.html#sponsors">participation</a>).
All of the open source based validations to date have been funded in whole or in
substantial part by U.S. government agencies, but only after very
extended periods of discussion and consideration. No such discussions are
in progress at this time, nor do we know of any prospects for such funding.
<p>
Even once fully funded an open source based validation can be expected to take
a minimum of 18 months or so, as each time new issues seem to arise even when the
basic functionality of the source is unchanged from previous validations. During
that time a validation is at risk of the introduction of yet more new
validation requirements<small><sup><a href="ig95.html#9">9</a></sup></small>,
so even once a validation is begun it isn't possible
to predict the schedule and outcome with any degree of confidence.
</blockquote>
<em>
<p>
Q6: What about the matching "FIPS capable" OpenSSL?
<p>
</em>
<blockquote>
That will need to be modified to match the new FIPS module, of course.
<p>
The FIPS module by itself is of little use to most application software
vendors. To our knowledge only one vendor has ever used the FIPS module
directly without OpenSSL, and that was for a very special and specific
application. The FIPS module was designed from the beginning to be used
in conjunction with OpenSSL in a configuration we call the "FIPS
Capable" OpenSSL, where the FIPS module is embedded in the OpenSSL
shared library (or library plus application as an executable file) and
all relevant cryptographic operations are seamlessly
diverted to the FIPS module when the FIPS mode of operation is enabled.
A major advantage of the "FIPS capable" OpenSSL is that vendors can ship
the same software to all of their customers, those who want the FIPS 140-2
validated cryptography and those who do not<small><sup><a href="ig95.html#10">10</a></sup></small>.
For many software products and markets the latter group of users is the largest.
<p>
The "FIPS capable" OpenSSL redirects allowed cryptography to the embedded FIPS
module and disables all other cryptography (those algorithm implementations <em>not</em> in the
FIPS module), and to be conservative<small><sup><a href="ig95.html#11">11</a></sup></small> we implemented the "FIPS capable"
OpenSSL 1.0.1 to unconditionally redirect some cryptographic operations
(SHA digests, for instance, which are the same for FIPS and non-FIPS implementations) to
the FIPS module.
<p>
So, a FIPS module that unconditionally disables those cryptographic operations
will break OpenSSL
for anyone who doesn't immediately enable FIPS mode, which is most
calling applications. Note that even aside from the fact that most users
won't want the overhead of the POST, it isn't possible for a library to
automatically perform POST processing in a portable way.
<p>
The proper treatment for a new FIPS capable OpenSSL for use with a
disabled-by-default FIPS module will be
to have OpenSSL ignore the FIPS module completely until and if it is referenced via
a call to the <em>FIPS_mode_set()</em><small><sup><a href="ig95.html#12">12</a></sup></small> function.
<p>
The OpenSSL FIPS Object Module 2.0 (#1747) is widely used and will
remain in widespread use for years, so even if a technical solution to
accommodate the new hacked FIPS module was possible we could not implement
any changes in the baseline OpenSSL that would affect use of the 2.0 FIPS
module. At best some sort of special build-time option<small><sup><a href="ig95.html#13">13</a></sup></small>
could be developed to accommodate a hacked FIPS module. We haven't studied that in detail
other than to note it would be a substantial amount of work.
</blockquote>
<em>
<p>
Q7: What are the best case prospects for a new I.G. 9.5 compatible FIPS
module and matching OpenSSL?
<p>
</em>
<blockquote>
Well, two things will need to happen:
<p>
<ul>
  <li>
A new FIPS module will need to be coded and validated. Even if we had
ample funding now (we don't) that will probably take between one and two years.
<p>
  <li>
A new OpenSSL release capable of dealing with a completely
non-functional FIPS module will need to be developed and released. Per
the existing OpenSSL versioning scheme<small><sup><a href="ig95.html#14">14</a></sup></small> for incompatible functional
changes, the earliest version of OpenSSL that could accommodate the
necessary changes would be release 1.0.2. That release is very tentatively planned
for early 2014.
</ul>
<p>
Note that the best-case scenario for a new "FIPS capable" OpenSSL
solution presumes ample funding which is very unlikely to materialize,
so for the foreseeable future the best option for most software vendors
will be to leverage the existing 2.0 FIPS module (see next question). It
also presumes that the necessary modifications to the code are
technically feasible in the first place.
</blockquote>
<em>
<p>
Q8: What is the worst case scenario?
<p>
</em>
<blockquote>
If we don't find substantial funding for the coding and validation work required, and also
find the enthusiasm for once again diverting a large proportion of our limited manpower
to a goal of interest to only a narrow segment<small><sup><a href="ig95.html#15">15</a></sup></small> of the
overall OpenSSL user community,
then the OpenSSL FIPS Object Module 2.0 (#1747) will be the end of the line in that
series of open source based validations. There will be no longer be a ready-made code base suitable as a
model for future private label validations.
<p>
<font color="#cc3333">UPDATE 2013-02-28:&nbsp;</font>With the exception of a temporary transitional
phase for partially completed validations this scenario appears to be the current reality.
</blockquote>
<em>
<p>
Q9: We need validated OpenSSL crypto now. What can we do?
<p>
</em>
<blockquote>
At present your best -- in fact only -- option is to leverage the existing 2.0 FIPS module
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm#1747">(#1747)</a>
by adding additional platforms as necessary. Over sixty platforms<small><sup><a href="ig95.html#16">16</a></sup></small>
have been formally tested
already and that number will continue to grow, and if your platform(s) of interest
aren't already covered they can be added at a relatively modest cost in time and
money (as compared to a full validation). Contact <a href="../contact.html">OSF</a> for
details on sponsoring additional platforms for the 2.0 FIPS module.
<p>
The 2.0 FIPS module is still relatively current<small><sup><a href="ig95.html#17">17</a></sup></small> so
using it does not expose you to severe technical deficiencies of the sort that could be
only be addressed in a new private label validation.
<p>
If you are really desperately eager to have a private label validation with a custom
hacked FIPS module and OpenSSL then <a href="../contact.html">give us a call</a>, but don't
expect to receive much encouragement. If you would like to sponsor a supported open source
based solution then we'd love to hear from you, but note that would be an expensive
proposition<small><sup><a href="ig95.html#18">18</a></sup></small>.
</blockquote>
<em>
<p>
Q10: Any chance the CMVP will reconsider?
<p>
</em>
<blockquote>
We're being asked this a lot. This impact of this requirement is widespread and we have heard
from multiple sources that some accredited test labs and affected vendors have already communicated
their concerns to the CMVP. A closed meeting between the test labs and CMVP occurred on February 27,
at which this issue was a primary topic of discussion. The CMVP has re-affirmed that new guidance
but subsequent preliminary feedback indicates they will permit a temporary transitional period to allow
currently in-process validations to be completed. Details on the terms of that
transitional period are as yet unknown.
<p>
If you wish to contact the CMVP with concerns or questions the CMVP contact
info is on the <a href="http://csrc.nist.gov/groups/STM/cmvp/contacts.html">NIST web site</a>.
Do keep in mind that there is no protest or appeals process; it's their sandbox and they make
the rules. It it possible, likely even, that the scale and severity of the impact of this
requirement was not fully anticipated by the CMVP, but upholding the sanctity of the FIPS 140-2 "scripture"
is their primary responsibility even in the face of unintended consequences.
</blockquote>
<p>
<p>
<p>
<small>
<div align="center">
- Footnotes -
<div align="left">
<sup>
<a name="1">1</a>
</sup>
We're told the CMVP is claiming this interpretation is not new and has been that way all along.
However, that interpretation has been unknown to us through many validations with many test labs, and from
numerous contacts with other software vendors such ignorance outside of the CMVP proper appears to have been
widespread if not universal.
If we had known of this requirement when design and development of the FIPS module began some 10 years ago
we could have accommodated it as part of the evolution of that design which was after all driven by
CMVP requirements.
<p>
<sup>
<a name="2">2</a>
</sup>
For our commercial clients we absorb as much of the risk of the validation process as we can, as that is
part of the "valued add" for our validation services. In this case that means we will absorb the full
cost of the substantial amount of labor that will be needed for recoding and retesting.
We will also have to pay the lab fees for the formal algorithm and
operational environment testing that will need to be repeated with the new code (or if the labs waive some
or all of those fees then they take a loss, as their testing effort is also non-trivial). At present
the losses we will
incur promise to be a substantial portion of our annual revenues. Ouch. If we ever do commence doing
private label validations again we will need to factor in this level of risk.
<p>
<sup>
<a name="3">3</a>
</sup>
The Power Up Self Test (POST) is an elaborate set of initialization tests mandated by FIPS 140-2. Roughly
speaking they consist of an integrity check to verify no bits have flipped in the executable code since it
was created, and
checks for the various algorithms which are basically complex mathematical tautologies (does 1+1=2?). The
algorithm tests won't fail unless there is something really wrong with the computing environment (1+1&ne;2).
So, for all practical purposes a POST failure will not occur and if it does you have far worse problems
than a failed crypto module.
<p>
<sup>
<a name="4">4</a>
</sup>
The <em>monolithic object module</em> is an invention born of the first validation attempt in order to satisfy
the peculiar requirements of FIPS 140-2; see section 2.3 of the FIPS module
<a href="http://www.openssl.org/docs/fips/UserGuide-2.0.pdf">User Guide</a>. In essense it is a
composite object module with the individual object modules forced in a specific order in terms of
ascending file or memory offsets. That ordering is technically irrelevant to the
behavior of the static linker during creation of the "fipscanister" object module and the final application
executable containing that object module.
All OpenSSL FIPS Object Module validations (and the many "private label" validations derived from them)
have featured this monolithic object module that is statically linked into an executable application
file. In practice that application often takes the form of the <em>libcrypto.so</em> shared library file (or
<em>libeay32.dll</em> for Windows
operating systems) for the "FIPS capable" OpenSSL, but for some platforms (e.g. Apple iOS) the FIPS module
is statically linked into the application executable. Implementing the FIPS module for static linking
exclusively was a strategic design decision from the beginning as there is no platform portable way to implement the
integrity test mandated by FIPS 140-2.
<p>
<sup>
<a name="5">5</a>
</sup>
In some very platform and architecture specific contexts hiding of selected global symbols in
object code may be possible, using sophisticated compiler and linker voodoo. See for instance
<a href="http://www.akkadia.org/drepper/dsohowto.pdf">Drepper, 2011-12-10</a>, section 2.2, for
one specific object code format (ELF). Such voodoo is not an option one would chose absent any other recourse.
<p>
<sup>
<a name="6">6</a>
</sup>
Appendix I of the
<em><a href="http://www.openssl.org/docs/fips/UserGuide-2.0.pdf">User Guide for the OpenSSL FIPS Object Module v.20</a></em>
was machine generated from the source code to satisfy a FIPS 140-2 documentation requirement
that such documentation exist. That documentation would not have been prepared otherwise
as it has minimal real-world utility; application programmers will not reference the FIPS module API directly except in
unusual circumstances in which source code would be consulted as a matter of course anyway.
That automation was developed to avoid the considerable labor costs of manually preparing
documentation for previous validations.
As such it documents every external function and is
not a useful guide to the FIPS module interface. That interface was designed for compatibility
with the "FIPS Capable" OpenSSL as described in that User Guide document, and not for direct reference by application
programmers. The source code to OpenSSL itself is the best description of the FIPS module
interface.
<p>
Should documentation prove to be a critical issue then it could be redone accordingly to
reference only selected functions, either by machine generation from the "FIPS Capable" OpenSSL
source and/or by filtering on the basis of the "blocking" mechanism as implemented in the
FIPS module. Either approach would be more accurate than manually drafted documentation.
<p>
<sup>
<a name="7">7</a>
</sup>
Almost invariably both identical or near identical cryptographic algorithm implementations, one
validated and one not, will reside in the same executable or shared library file. The "FIPS
capable" OpenSSL will preferentially use the non-validated algorithm implementations as those
are actively maintained to incorporate bugfixes and performance improvements (unlike the FIPS
module which effectively cannot be maintained). So, this blocking will be for the purpose of
preventing use by an application when such access is undesirable anyway.
<p>
<sup>
<a name="8">8</a>
</sup>
While the open source based validations use the same or very similar source code as many conventional
proprietary binary validations they are subjected to a much higher level of scrutiny that significantly drives
up the cost.
<p>
<sup>
<a name="9">9</a>
</sup>
Requirement changes can impact ongoing validations up to the point where the formal
test report is submitted to the CMVP by the accredited test lab; that is to say after all
the design, implementation, and testing work has been completed. Until that point, a
period that can span many months for a typical validation, new requirements can mean major
rework and expense. That risk should be factored into the contingency planning for any
validation effort.
<p>
<sup>
<a name="10">10</a>
</sup>
Some users won't know or care one way or the other whether the products they purchase use FIPS 140-2
validated cryptography, but some specifically do <em>not</em> want validated cryptography: it is inherently less secure
(in the real-world sense of resistance to malicious compromise)
than the equivalent unvalidated implementations; a blanket restriction to the FIPS 140-2 approved algorithms can cause
interoperability issues; and for some algorithms performance is inferior. Absent a specific policy mandate there
is no reason to use validated cryptography; it is not "better" in any technical or functional sense and is much
more difficult to maintain.
<p>
<sup>
<a name="11">11</a>
</sup>
As an aid to conversion of existing OpenSSL based applications to use of FIPS validated cryptography
we put a lot of effort into having the "FIPS capable" OpenSSL API automatically provide the appropriate behavior.
When FIPS mode is enabled the calling application is not supposed to invoke any non-validated cryptographic
algorithm implementations. Due to the complexity of the legacy OpenSSL API, handling the redirection automatically and
comprehensively is a bit tricky. Where there was a chance that redirection of a cryptographic operation to the
validated implementation might fail we erred on the side of caution by unconditionally referencing the validated
implementation where the FIPS module is present. That is done for instance for the SHA digests, where for the
present at least the validated and unvalidated implementations are identical.
<p>
<sup>
<a name="12">12</a>
</sup>
The <em>FIPS_mode_set()</em> function is actually defined in the FIPS capable OpenSSL, not the
FIPS module. It initializes the passthrough and disabling mechanisms in OpenSSL and calls the
<em>FIPS_module_mode_set()</em> function defined in the FIPS module which actually enables the FIPS module
of operation.
<p>
<sup>
<a name="13">13</a>
</sup>
The tentative name for the associated macro is OPENSSL_FIPS_IG_9_5_BOLLOCKS. We do try to keep our
sense of humor.
<p>
<sup>
<a name="14">14</a>
</sup>
Briefly stated "letter" revisions (e.g. 1.0.1e) are for bugfixes only; the introduction of new features
requires a "number" release (e.g. 1.0.2). The argument has been advanced that a new crippled FIPS module
could be considered a bug, but before adding any such support to the 1.0.1 baseline we would have
to be absolutely sure the existing #1747 validated module was not affected.
<p>
<sup>
<a name="15">15</a>
</sup>
When working on FIPS 140-2 validation issues it's easy to forget that they are of interest to only
some OpenSSL users. Use of FIPS 140-2 validated cryptography is mandated for the U.S. and Canadian governments,
and is of some interest in selected commercial settings (financial, health care industries) in North America and
Europe, but of little or no interest throughout most of the world and for very large sectors of the software
industry. A valid argument can be made that too many scarce OpenSSL resources have been already consumed in accommodating
the peculiar requirements of FIPS 140-2 instead of improving the OpenSSL product in general.
<p>
<sup>
<a name="16">16</a>
</sup>
The #1747 validation includes more tested platforms ("Operational Environments") than any other validation. We
believe it also includes the largest number of algorithms.
<p>
<sup>
<a name="17">17</a>
</sup>
The current OpenSSL FIPS Object Module 2.0 (#1747) does not support GMAC, and the FIPS module with the
associated "FIPS capable" OpenSSL 1.0.1 does not fully address the
<a href="http://www.isg.rhul.ac.uk/tls/">"Lucky Thirteen"</a> TLS vulnerability. We have been adding
GMAC support to recent private label validations. The TLS vulnerability could potentially, though not easily,
be addressed for new private label validations but this latest issue makes that moot. As with GMAC support
that vulnerability can't be fully addressed for the existing 2.0 module because of the practical
impossibility of changing an existing validated module.
<p>
<sup>
<a name="18">18</a>
</sup>
We've been asked this several times already and don't have a ready answer as the cost will depend on
a more thorough analysis of the coding issues and external factors such as the accredited test lab fees.
The coding work alone will probably cost a minimum of mid five figures (US$50,000+) and in the low-to-mid
six figures at least for a formal FIPS 140-2 validation. That assumes compliance is even theoretically
possible (see earlier <a href="ig95.html#4">footnote</a> on the meaning of "all" functions).
<p>
</small>
</div>
<div align="center">
<a name="updates">
  <small>- Update History -</small>
</a>
</div>
<div align="left">
<small>
<dl>
  <dt>2013-08-12</dt>
    <dd>
	Added new section discussing the July 25 I.G. update
    </dd>
  <dt>2013-03-14</dt>
    <dd>
	Q2: Note transition deadline of November 15
    </dd>
  <dt>2013-03-01</dt>
    <dd>
	More detail for new footnote #4.
	New footnote #9 added and all earlier footnotes #8 and above incremented by one.
    </dd>
  <dt>2013-02-27</dt>
    <dd>
	Added preliminary feedback from 2013-02-27 manager's meeting<br>
	Added new footnote #4, #5, and #6 for Q4, all earlier footnotes #4 and above incremented by three.
    </dd>
  <dt>2013-02-27</dt>
    <dd>
	Multiple edits and new footnotes
    </dd>
  <dt> 2013-02-12</dt>
    <dd>
	Initial draft
    </dd>
</dl>
</small>
<sup>
	</td>
  </tr>
  <tr>
    <td valign="bottom" bgcolor="#ffffff">
      <table width="100%" border="0" summary="">
	<tbody>
          <tr>
            <td>
              <hr>
              <small>
              <em>This site Copyright &#169; 2009-2014 OSF.</em>
              </small>
            </td>
          </tr>
        </tbody>
      </table>
    </td>
  </tr>
</tbody>
</table>
</body>
</html>

