<html>
<head>
<!--
     Copyright (c) 1998-2014 The OpenSSL Project, http://www.openssl.org/
     Author:   OpenSSL (openssl@openssl.org)
     Modified: 2014-08-29 01:00:23.
     Generated from ``des_modes.wml'' via WML 2.0.11 (19-Aug-2006).
               by OpenSSL (openssl@openssl.org)
               on 2014-08-29 01:00:50.

     DO NOT EDIT THIS FILE DIRECTLY! INSTEAD EDIT ``des_modes.wml''.
-->
<meta name="Copyright" content="1998-2014 The OpenSSL Project, http://www.openssl.org/">
<meta name="Author"    content="OpenSSL, openssl@openssl.org">
<meta name="Generator" content="WML 2.0.11 (19-Aug-2006)">
<meta name="Modified"  content="2014-08-29 01:00:23">
<title>OpenSSL: Documents, des_modes(7)</title>
<style type="text/css"><!--
BODY { position: absolute; left: 0px; top: 0px; background: #666699; }
A { text-decoration: none; font-weight: bold; }
A:link { text-decoration: none; font-weight: bold; color: #666699; }
A:visited { text-decoration: none; font-weight: bold; color: #666699; }
A:hover { text-decoration: none; font-weight: bold; color: #666699; text-decoration: underline; }
#red { color: #cc3333; }
#sf { font-family: arial,helvetica; font-variant: normal; font-style: normal; }
#sfl { font-weight: bold; font-family: arial,helvetica; font-size: 16pt; line-height: 16pt; font-variant: normal; font-style: normal; }
H1 { font-weight: bold; font-size: 18pt; line-height: 18pt; font-family: arial,helvetica; font-variant: normal; font-style: normal; }
H2 { font-weight: bold; font-size: 14pt; line-height: 14pt; font-family: arial,helvetica; font-variant: normal; font-style: normal; }
H3 { font-weight: bold; font-size: 12pt; line-height: 12pt; font-family: arial,helvetica; font-variant: normal; font-style: normal; }
--></style>
</head>
<body link="#6666cc" alink="#6666cc" vlink="#6666cc" bgcolor="#666699" text="#000000"
      marginheight="0" leftmargin="0" rightmargin="0" topmargin="0">
<table width="100%" cellspacing="0" cellpadding="0" border="0" summary="">
  <tr><td align="left" width="100" bgcolor="#666699"><img src="../../images/page-head-tl.jpg" alt="OpenSSL" width="100" height="80"></td><td align="left" colspan="2" width="600" bgcolor="#666699"><img src="../../images/page-head-tm.jpg" alt="" width="600" height="80"></td><td align="right" width="20" bgcolor="#666699">&nbsp;&nbsp;&nbsp;</td><td align="right" width="50" bgcolor="#666699">&nbsp;</td></tr>
  <tr><td align="left" width="100"><img src="../../images/page-head-bl.jpg" alt="" width="100" height="20"></td><td align="left" width="20"><img src="../../images/page-head-bm.jpg" alt="" width="20" height="20"></td><td align="left" width="100%" bgcolor="#ffffff">
<table cellspacing="0" cellpadding="0" border="0" summary="">
        <tr>
<td><font face="Arial,Helvetica">&nbsp;<a href="../index.html" onmouseover="self.status = '../'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../'; return true" onblur="self.status = ''; return true"><font color="#666666">Documents</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="../apps/openssl.html" onmouseover="self.status = '../apps/openssl.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../apps/openssl.html'; return true" onblur="self.status = ''; return true"><font color="#666666">openssl(1)</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="../ssl/ssl.html" onmouseover="self.status = '../ssl/ssl.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../ssl/ssl.html'; return true" onblur="self.status = ''; return true"><font color="#666666">ssl(3)</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="crypto.html" onmouseover="self.status = '../crypto/crypto.html'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../crypto/crypto.html'; return true" onblur="self.status = ''; return true"><font color="#666666">crypto(3)</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="../HOWTO/index.html" onmouseover="self.status = '../HOWTO/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../HOWTO/'; return true" onblur="self.status = ''; return true"><font color="#666666">HOWTO</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="http://wiki.openssl.org/" onmouseover="self.status = 'http://wiki.openssl.org/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = 'http://wiki.openssl.org/'; return true" onblur="self.status = ''; return true"><font color="#666666">Wiki</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="../fips/index.html" onmouseover="self.status = '../fips/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../fips/'; return true" onblur="self.status = ''; return true"><font color="#666666">FIPS140</font></a></font>&nbsp;</td><td>|</td>
<td><font face="Arial,Helvetica">&nbsp;<a href="../misc/index.html" onmouseover="self.status = '../misc/'; return true" onmouseout="self.status = ''; return true" onfocus="self.status = '../misc/'; return true" onblur="self.status = ''; return true"><font color="#666666">misc</font></a></font>&nbsp;</td><td></td>
</tr>
      </table>
</td><td align="right" width="20"><img src="../../images/page-corner-tr.gif" alt="" width="20" height="20"></td><td align="right" width="50" bgcolor="#666699">&nbsp;</td></tr>
  <tr><td align="left" valign="top" width="100" bgcolor="#666699"><table cellspacing="0" cellpadding="0" border="0" summary=""><tr><td><img src="../../images/page-navbar-top.jpg" alt="" width="100" height="11"></td></tr>
<script type="text/javascript" language="JavaScript">
<!-- Hiding the code
function nb_imgNormal(imgName) {
    if (document.images) {
        document[imgName].src = eval(imgName + '_n.src');
        self.status = '';
    }
}
function nb_imgSelect(imgName) {
    if (document.images) {
        document[imgName].src = eval(imgName + '_s.src');
        self.status = '';
    }
}
function nb_imgOver(imgName, nohints, descript) {
    if (document.images) {
        document[imgName].src = eval(imgName + '_o.src');
        if (! nohints) self.status = descript;
    }
}
// done hiding -->
</script>
<script type="text/javascript" language="JavaScript">
<!-- Hiding the code
if (document.images) {
    nb_img1_title_n = new Image();
    nb_img1_title_n.src = '../../images/page-navbar-ti-n.jpg';
    nb_img1_title_o = new Image();
    nb_img1_title_o.src = '../../images/page-navbar-ti-s.jpg';
    nb_img1_FAQ_n = new Image();
    nb_img1_FAQ_n.src = '../../images/page-navbar-fq-n.jpg';
    nb_img1_FAQ_o = new Image();
    nb_img1_FAQ_o.src = '../../images/page-navbar-fq-s.jpg';
    nb_img1_about_n = new Image();
    nb_img1_about_n.src = '../../images/page-navbar-ab-n.jpg';
    nb_img1_about_o = new Image();
    nb_img1_about_o.src = '../../images/page-navbar-ab-s.jpg';
    nb_img1_news_n = new Image();
    nb_img1_news_n.src = '../../images/page-navbar-ne-n.jpg';
    nb_img1_news_o = new Image();
    nb_img1_news_o.src = '../../images/page-navbar-ne-s.jpg';
    nb_img1_docs_s = new Image();
    nb_img1_docs_s.src = '../../images/page-navbar-do-s.jpg';
    nb_img1_docs_o = new Image();
    nb_img1_docs_o.src = '../../images/page-navbar-do-s.jpg';
    nb_img1_source_n = new Image();
    nb_img1_source_n.src = '../../images/page-navbar-so-n.jpg';
    nb_img1_source_o = new Image();
    nb_img1_source_o.src = '../../images/page-navbar-so-s.jpg';
    nb_img1_contrib_n = new Image();
    nb_img1_contrib_n.src = '../../images/page-navbar-co-n.jpg';
    nb_img1_contrib_o = new Image();
    nb_img1_contrib_o.src = '../../images/page-navbar-co-s.jpg';
    nb_img1_support_n = new Image();
    nb_img1_support_n.src = '../../images/page-navbar-su-n.jpg';
    nb_img1_support_o = new Image();
    nb_img1_support_o.src = '../../images/page-navbar-su-s.jpg';
    nb_img1_related_n = new Image();
    nb_img1_related_n.src = '../../images/page-navbar-re-n.jpg';
    nb_img1_related_o = new Image();
    nb_img1_related_o.src = '../../images/page-navbar-re-s.jpg';
}
// done hiding -->
</script>
<tr><td><a href="../../index.html" onmouseover="nb_imgOver('nb_img1_title', 0, 'Title'); return true" onmouseout="nb_imgNormal('nb_img1_title'); return true" onfocus="nb_imgOver('nb_img1_title', 0, 'Title'); return true" onblur="nb_imgNormal('nb_img1_title'); return true"><img name="nb_img1_title" src="../../images/page-navbar-ti-n.jpg" alt="Title" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../support/faq.html" onmouseover="nb_imgOver('nb_img1_FAQ', 0, 'FAQ'); return true" onmouseout="nb_imgNormal('nb_img1_FAQ'); return true" onfocus="nb_imgOver('nb_img1_FAQ', 0, 'FAQ'); return true" onblur="nb_imgNormal('nb_img1_FAQ'); return true"><img name="nb_img1_FAQ" src="../../images/page-navbar-fq-n.jpg" alt="FAQ" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../about/index.html" onmouseover="nb_imgOver('nb_img1_about', 0, 'About'); return true" onmouseout="nb_imgNormal('nb_img1_about'); return true" onfocus="nb_imgOver('nb_img1_about', 0, 'About'); return true" onblur="nb_imgNormal('nb_img1_about'); return true"><img name="nb_img1_about" src="../../images/page-navbar-ab-n.jpg" alt="About" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../news/index.html" onmouseover="nb_imgOver('nb_img1_news', 0, 'News'); return true" onmouseout="nb_imgNormal('nb_img1_news'); return true" onfocus="nb_imgOver('nb_img1_news', 0, 'News'); return true" onblur="nb_imgNormal('nb_img1_news'); return true"><img name="nb_img1_news" src="../../images/page-navbar-ne-n.jpg" alt="News" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../index.html" onmouseover="nb_imgOver('nb_img1_docs', 0, 'Documents'); return true" onmouseout="nb_imgSelect('nb_img1_docs'); return true" onfocus="nb_imgOver('nb_img1_docs', 0, 'Documents'); return true" onblur="nb_imgSelect('nb_img1_docs'); return true"><img name="nb_img1_docs" src="../../images/page-navbar-do-s.jpg" alt="Documents" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../source/index.html" onmouseover="nb_imgOver('nb_img1_source', 0, 'Source'); return true" onmouseout="nb_imgNormal('nb_img1_source'); return true" onfocus="nb_imgOver('nb_img1_source', 0, 'Source'); return true" onblur="nb_imgNormal('nb_img1_source'); return true"><img name="nb_img1_source" src="../../images/page-navbar-so-n.jpg" alt="Source" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../contrib/index.html" onmouseover="nb_imgOver('nb_img1_contrib', 0, 'Contribution'); return true" onmouseout="nb_imgNormal('nb_img1_contrib'); return true" onfocus="nb_imgOver('nb_img1_contrib', 0, 'Contribution'); return true" onblur="nb_imgNormal('nb_img1_contrib'); return true"><img name="nb_img1_contrib" src="../../images/page-navbar-co-n.jpg" alt="Contribution" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../support/index.html" onmouseover="nb_imgOver('nb_img1_support', 0, 'Support'); return true" onmouseout="nb_imgNormal('nb_img1_support'); return true" onfocus="nb_imgOver('nb_img1_support', 0, 'Support'); return true" onblur="nb_imgNormal('nb_img1_support'); return true"><img name="nb_img1_support" src="../../images/page-navbar-su-n.jpg" alt="Support" border="0" width="100" height="27"></a></td></tr>
<tr><td><a href="../../related/index.html" onmouseover="nb_imgOver('nb_img1_related', 0, 'Related'); return true" onmouseout="nb_imgNormal('nb_img1_related'); return true" onfocus="nb_imgOver('nb_img1_related', 0, 'Related'); return true" onblur="nb_imgNormal('nb_img1_related'); return true"><img name="nb_img1_related" src="../../images/page-navbar-re-n.jpg" alt="Related" border="0" width="100" height="27"></a></td></tr>
    <tr><td><img src="../../images/page-navbar-bot.jpg" alt="" width="100" height="150"><br><p></td></tr>
  </table>
</td><td align="left" valign="top" width="20" bgcolor="#ffffff">&nbsp;</td><td align="left" valign="top" bgcolor="#ffffff"><br>
        
<h1>des_modes(7)</h1>
<!-- INDEX BEGIN -->
<UL>
	<LI><A HREF="des_modes.html#NAME">NAME</A>
	<LI><A HREF="des_modes.html#DESCRIPTION">DESCRIPTION</A>
	<LI><A HREF="des_modes.html#OVERVIEW">OVERVIEW</A>
	<UL>
		<LI><A HREF="des_modes.html#Electronic_Codebook_Mode_ECB_">Electronic Codebook Mode (ECB)</A>
		<LI><A HREF="des_modes.html#Cipher_Block_Chaining_Mode_CBC_">Cipher Block Chaining Mode (CBC)</A>
		<LI><A HREF="des_modes.html#Cipher_Feedback_Mode_CFB_">Cipher Feedback Mode (CFB)</A>
		<LI><A HREF="des_modes.html#Output_Feedback_Mode_OFB_">Output Feedback Mode (OFB)</A>
		<LI><A HREF="des_modes.html#Triple_ECB_Mode">Triple ECB Mode</A>
		<LI><A HREF="des_modes.html#Triple_CBC_Mode">Triple CBC Mode</A>
	</UL>
	<LI><A HREF="des_modes.html#NOTES">NOTES</A>
	<LI><A HREF="des_modes.html#SEE_ALSO">SEE ALSO</A>
</UL>
<!-- INDEX END -->
<HR>
<P>
<HR>
<H1><A NAME="NAME">NAME</A></H1>
<P>
des_modes - the variants of DES and other crypto algorithms of OpenSSL
</P>
<P>
<HR>
<H1><A NAME="DESCRIPTION">DESCRIPTION</A></H1>
<P>
Several crypto algorithms for OpenSSL can be used in a number of modes.
Those are used for using block ciphers in a way similar to stream ciphers,
among other things.
</P>
<P>
<HR>
<H1><A NAME="OVERVIEW">OVERVIEW</A></H1>
<P>
<HR>
<H2><A NAME="Electronic_Codebook_Mode_ECB_">Electronic Codebook Mode (ECB)</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_ecb_encrypt().</CODE>
</P>
<UL>
<LI>
<P>
64 bits are enciphered at a time.
</P>
<LI>
<P>
The order of the blocks can be rearranged without detection.
</P>
<LI>
<P>
The same plaintext block always produces the same ciphertext block (for the
same key) making it vulnerable to a 'dictionary attack'.
</P>
<LI>
<P>
An error will only affect one ciphertext block.
</P>
</UL>
<P>
<HR>
<H2><A NAME="Cipher_Block_Chaining_Mode_CBC_">Cipher Block Chaining Mode (CBC)</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_cbc_encrypt().</CODE> Be aware that <CODE>des_cbc_encrypt()</CODE>
is not really DES CBC (it does not update the IV); use
<CODE>des_ncbc_encrypt()</CODE> instead.
</P>
<UL>
<LI>
<P>
a multiple of 64 bits are enciphered at a time.
</P>
<LI>
<P>
The CBC mode produces the same ciphertext whenever the same plaintext is
encrypted using the same key and starting variable.
</P>
<LI>
<P>
The chaining operation makes the ciphertext blocks dependent on the current
and all preceding plaintext blocks and therefore blocks can not be
rearranged.
</P>
<LI>
<P>
The use of different starting variables prevents the same plaintext
enciphering to the same ciphertext.
</P>
<LI>
<P>
An error will affect the current and the following ciphertext blocks.
</P>
</UL>
<P>
<HR>
<H2><A NAME="Cipher_Feedback_Mode_CFB_">Cipher Feedback Mode (CFB)</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_cfb_encrypt().</CODE>
</P>
<UL>
<LI>
<P>
a number of bits (j) &lt;= 64 are enciphered at a time.
</P>
<LI>
<P>
The CFB mode produces the same ciphertext whenever the same plaintext is
encrypted using the same key and starting variable.
</P>
<LI>
<P>
The chaining operation makes the ciphertext variables dependent on the
current and all preceding variables and therefore j-bit variables are
chained together and can not be rearranged.
</P>
<LI>
<P>
The use of different starting variables prevents the same plaintext
enciphering to the same ciphertext.
</P>
<LI>
<P>
The strength of the CFB mode depends on the size of k (maximal if j == k).
In my implementation this is always the case.
</P>
<LI>
<P>
Selection of a small value for j will require more cycles through the
encipherment algorithm per unit of plaintext and thus cause greater
processing overheads.
</P>
<LI>
<P>
Only multiples of j bits can be enciphered.
</P>
<LI>
<P>
An error will affect the current and the following ciphertext variables.
</P>
</UL>
<P>
<HR>
<H2><A NAME="Output_Feedback_Mode_OFB_">Output Feedback Mode (OFB)</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_ofb_encrypt().</CODE>
</P>
<UL>
<LI>
<P>
a number of bits (j) &lt;= 64 are enciphered at a time.
</P>
<LI>
<P>
The OFB mode produces the same ciphertext whenever the same plaintext
enciphered using the same key and starting variable. More over, in the OFB
mode the same key stream is produced when the same key and start variable
are used. Consequently, for security reasons a specific start variable
should be used only once for a given key.
</P>
<LI>
<P>
The absence of chaining makes the OFB more vulnerable to specific attacks.
</P>
<LI>
<P>
The use of different start variables values prevents the same plaintext
enciphering to the same ciphertext, by producing different key streams.
</P>
<LI>
<P>
Selection of a small value for j will require more cycles through the
encipherment algorithm per unit of plaintext and thus cause greater
processing overheads.
</P>
<LI>
<P>
Only multiples of j bits can be enciphered.
</P>
<LI>
<P>
OFB mode of operation does not extend ciphertext errors in the resultant
plaintext output. Every bit error in the ciphertext causes only one bit to
be in error in the deciphered plaintext.
</P>
<LI>
<P>
OFB mode is not self-synchronizing. If the two operation of encipherment
and decipherment get out of synchronism, the system needs to be
re-initialized.
</P>
<LI>
<P>
Each re-initialization should use a value of the start variable different
from the start variable values used before with the same key. The reason
for this is that an identical bit stream would be produced each time from
the same parameters. This would be susceptible to a 'known plaintext'
attack.
</P>
</UL>
<P>
<HR>
<H2><A NAME="Triple_ECB_Mode">Triple ECB Mode</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_ecb3_encrypt().</CODE>
</P>
<UL>
<LI>
<P>
Encrypt with key1, decrypt with key2 and encrypt with key3 again.
</P>
<LI>
<P>
As for ECB encryption but increases the key length to 168 bits. There are
theoretic attacks that can be used that make the effective key length 112
bits, but this attack also requires 2^56 blocks of memory, not very likely,
even for the NSA.
</P>
<LI>
<P>
If both keys are the same it is equivalent to encrypting once with just one
key.
</P>
<LI>
<P>
If the first and last key are the same, the key length is 112 bits. There
are attacks that could reduce the effective key strength to only slightly
more than 56 bits, but these require a lot of memory.
</P>
<LI>
<P>
If all 3 keys are the same, this is effectively the same as normal ecb
mode.
</P>
</UL>
<P>
<HR>
<H2><A NAME="Triple_CBC_Mode">Triple CBC Mode</A></H2>
<P>
Normally, this is found as the function <EM>algorithm</EM><CODE>_ede3_cbc_encrypt().</CODE>
</P>
<UL>
<LI>
<P>
Encrypt with key1, decrypt with key2 and then encrypt with key3.
</P>
<LI>
<P>
As for CBC encryption but increases the key length to 168 bits with the
same restrictions as for triple ecb mode.
</P>
</UL>
<P>
<HR>
<H1><A NAME="NOTES">NOTES</A></H1>
<P>
This text was been written in large parts by Eric Young in his original
documentation for SSLeay, the predecessor of OpenSSL. In turn, he
attributed it to:
</P>
<PRE>        AS 2805.5.2
        Australian Standard
        Electronic funds transfer - Requirements for interfaces,
        Part 5.2: Modes of operation for an n-bit block cipher algorithm
        Appendix A
</PRE>
<P>
<HR>
<H1><A NAME="SEE_ALSO">SEE ALSO</A></H1>
<P>
<A HREF="blowfish.html#">blowfish(3)</A>, <A HREF="des.html#">des(3)</A>, <EM>idea(3)</EM>,
<EM>rc2(3)</EM>
</P>
        </td><td align="right" width="20" bgcolor="#ffffff">&nbsp;&nbsp;&nbsp;</td><td align="right" width="50" bgcolor="#666699">&nbsp;</td></tr>
  <tr><td align="left" valign="top" width="100" bgcolor="#666699">&nbsp;</td><td align="left" width="20"><img src="../../images/page-corner-bl.gif" alt="" width="20" height="20"></td><td align="left" valign="top" bgcolor="#ffffff">&nbsp;</td><td align="right" width="20"><img src="../../images/page-corner-br.gif" alt="" width="20" height="20"></td><td align="right" width="50" bgcolor="#666699">&nbsp;</td></tr>
  <tr><td colspan="5" bgcolor="#666699">&nbsp;</td></tr>
</table>
</body>
</html>

